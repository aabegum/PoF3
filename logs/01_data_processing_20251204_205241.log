2025-12-04 20:52:41 - INFO - ================================================================================
2025-12-04 20:52:41 - INFO - 01_data_processing - PoF3 Data Processing
2025-12-04 20:52:41 - INFO - ================================================================================
2025-12-04 20:52:41 - INFO - Analysis date: 2025-12-04 00:00:00
2025-12-04 20:52:41 - INFO - 
2025-12-04 20:52:41 - INFO - [STEP] 1. Loading data
2025-12-04 20:52:41 - INFO - [STEP] Loading fault data from: data/inputs/fault_merged_data.xlsx
2025-12-04 20:52:48 - INFO - [OK] Loaded fault data: 10,884 rows, 173 columns
2025-12-04 20:52:48 - INFO - [OK] Fault records with cbs_id: 8,693
2025-12-04 20:52:48 - INFO - [INFO] Raw duration median (as given): 6869406.00
2025-12-04 20:52:48 - INFO - [INFO] Detected millisecond-scale durations. Converting to minutes (value / 60000).
2025-12-04 20:52:48 - INFO - [INFO] Extracted equipment types from 'Şebeke Unsuru'.
2025-12-04 20:52:48 - INFO - [OK] Final fault data for processing: 8,693 rows.
2025-12-04 20:52:48 - INFO - [STEP] Loading healthy equipment data from: data/inputs/health_merged_data.xlsx
2025-12-04 20:52:49 - WARNING - [WARN] Healthy data uses 'ID' instead of 'cbs_id' – mapping 'ID' → 'cbs_id' (DEPRECATED, fix at source).
2025-12-04 20:52:49 - INFO - [INFO] Extracted equipment types from 'Şebeke Unsuru'.
2025-12-04 20:52:49 - INFO - [OK] Final healthy equipment records: 3,153
2025-12-04 20:52:49 - INFO - 
2025-12-04 20:52:49 - INFO - [STEP] 2. Building fault events table
2025-12-04 20:52:49 - INFO - [OK] Fault events table created: 8,693 records.
2025-12-04 20:52:49 - INFO - 
2025-12-04 20:52:49 - INFO - [STEP] 3. Building equipment master
2025-12-04 20:52:49 - INFO - [STEP] Building equipment master table.
2025-12-04 20:52:49 - INFO - [OK] Equipment master initial size: 6,313
2025-12-04 20:52:49 - INFO - [INFO] Grouping rare equipment types into 'Other': ['Jumper']
2025-12-04 20:52:49 - INFO - [OK] Equipment master finalized: 6,313 unique equipment.
2025-12-04 20:52:49 - INFO - 
2025-12-04 20:52:49 - INFO - [STEP] 4. Building survival base
2025-12-04 20:52:49 - INFO - [STEP] Building survival base table.
2025-12-04 20:52:49 - ERROR - [FATAL] 01_data_processing failed: 'Ilk_Ariza_Tarihi'
Traceback (most recent call last):
  File "C:\Users\begum.orhan\source\repos\PoF3\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Ilk_Ariza_Tarihi'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\begum.orhan\source\repos\PoF3\pipeline\01_data_processing.py", line 446, in main
    survival_base = build_survival_base(equipment_master, fault_events, logger)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\begum.orhan\source\repos\PoF3\pipeline\01_data_processing.py", line 395, in build_survival_base
    eq["event"] = eq["Ilk_Ariza_Tarihi"].notna().astype(int)
                  ~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\begum.orhan\source\repos\PoF3\.venv\Lib\site-packages\pandas\core\frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\begum.orhan\source\repos\PoF3\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'Ilk_Ariza_Tarihi'
